<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keywords" content="é›€é­‚,é›€é­‚ç‰Œè°±è½¬æ¢,Majsoul">
    <meta name="description" content="é›€é­‚ç‰Œè°±é“¾æ¥è½¬æ¢å™¨">
    <title>é›€é­‚ç‰Œè°±é“¾æ¥è½¬æ¢å™¨</title>
</head>

<body>
    <div>
        <p><a href="/index.html">ğŸ”šå›åˆ°é¦–é¡µ</a> &nbsp; <a href="./index.html">ğŸ”™å›åˆ°é›€é­‚å·¥å…·ç®±</a></p>
    </div>
    <hr>
    <h1>é›€é­‚ç‰Œè°±é“¾æ¥è½¬æ¢å™¨</h1>
    <p>ç”¨äºè½¬æ¢æ™®é€šç‰Œè°±é“¾æ¥å’ŒåŒ¿åç‰Œè°±é“¾æ¥ï¼Œè¿˜å¯ä»¥ä¿®æ”¹è¿›å…¥ç‰Œè°±æ—¶çš„ä¸»è§†è§’ã€‚</p>

    <fieldset>
        <legend><b>æ™®é€šç‰Œè°±é“¾æ¥â†”ï¸åŒ¿åç‰Œè°±é“¾æ¥</b></legend>
        <div style="display: grid;align-items: center;">
            <textarea id="origin" rows="10" placeholder="è¿™é‡Œè¾“å…¥æ™®é€šç‰Œè°±é“¾æ¥ï¼Œæ¯è¡Œä¸€ä¸ª"></textarea>
            <br>
            <div>
                <button onclick="origin2encode()">â¬‡ï¸æ™®é€šè½¬åŒ¿å</button>
                <button onclick="encode2origin()">â¬†ï¸åŒ¿åè½¬æ™®é€š</button>
            </div>
            <br>
            <textarea id="encode" rows="10" placeholder="è¿™é‡Œè¾“å…¥åŒ¿åç‰Œè°±é“¾æ¥ï¼Œæ¯è¡Œä¸€ä¸ª"></textarea>
            <div id="result"></div>
        </div>

    </fieldset>

    <hr>

    <fieldset>
        <legend><b>ä¿®æ”¹ç‰Œè°±ä¸»è§†è§’</b></legend>
        <p>âš ï¸è¯·æ³¨æ„ï¼Œè´¦å·idéœ€è¦é€šè¿‡ä¸€å®šæ‰‹æ®µè·å–ï¼Œå¯ä»¥ä½¿ç”¨<a href="https://github.com/Avenshy/MajsoulMax" target="_blank">MajsoulMax</a>ã€‚
        </p>
        <div style="display: grid;align-items: center;">
            <input id="trans" placeholder="è¿™é‡Œè¾“å…¥ç‰Œè°±é“¾æ¥">
            <br>
            <div>
                <input type="radio" name="trans" id="accountid" checked />
                <label for="choice1">è´¦å·id</label>
                <input type="radio" name="trans" id="friendid" />
                <label for="choice2">å¥½å‹id</label>
                <input id="inputid" placeholder="è¿™é‡Œè¾“å…¥è´¦å·idæˆ–å¥½å‹id">
            </div>

            <br>
            <div>
                <button onclick="trans()">ğŸ”„è½¬æ¢</button>
            </div>
            <br>
            <input id="transuuid" placeholder="è¿™é‡Œæ˜¯ç”Ÿæˆçš„ç‰Œè°±é“¾æ¥">
            <div id="transresult"></div>
        </div>
    </fieldset>


    <hr>
    <p>ğŸ‘»ä½œè€…ï¼š<a href="https://github.com/Avenshy/" target="_blank">Avenshy</a></p>
    <p>ğŸµè¯·ä½œè€…å–èŒ¶ï¼š<a href="https://afdian.net/a/Avenshy" target="_blank">çˆ±å‘ç”µï¼ˆæ”¯æŒå¾®ä¿¡/æ”¯ä»˜å®ï¼‰</a></p>
    <p>â˜•è¯·ä½œè€…å–å’–å•¡ï¼š<a href="https://patreon.com/Avenshy" target="_blank">Patreonï¼ˆæ”¯æŒä¿¡ç”¨å¡/Paypalï¼‰</a></p>
    <p>âœˆï¸TGé¢‘é“ï¼š<a href="https://t.me/Mahjong_Soul">[Channel] é›€é­‚ç ”ç©¶é™¢</a></p>
    <p>âœˆï¸TGäº¤æµç¾¤ï¼š<a href="https://t.me/Mahjong_Soul_Chat">[Chat] é›€é­‚ç ”ç©¶é™¢</a></p>


    <script>
        function encodePaipuUUID(uuid) {
            let result = '';
            for (let code0 = '0'.charCodeAt(0), codeA = 'a'.charCodeAt(0), i = 0; i < uuid.length; i++) {
                let char = uuid.charAt(i);
                let code = char.charCodeAt(0);
                let temp = -1;
                if (code >= code0 && code0 + 10 > code) {
                    temp = code - code0;
                } else if (code >= codeA && codeA + 26 > code) {
                    temp = code - codeA + 10;
                }
                if (-1 != temp) {
                    temp = (temp + 17 + i) % 36;
                    if (10 > temp) {
                        result += String.fromCharCode(temp + code0);
                    } else {
                        result += String.fromCharCode(temp + codeA - 10);
                    }
                } else {
                    result += char;
                }
            }
            return result;
        }
        function decodePaipuUUID(uuid) {
            let result = '';
            for (let code0 = "0".charCodeAt(0), codeA = "a".charCodeAt(0), i = 0; i < uuid.length; i++) {
                let char = uuid.charAt(i);
                let code = char.charCodeAt(0);
                let temp = -1;
                if (code >= code0 && code0 + 10 > code) {
                    temp = code - code0;
                }
                else if (code >= codeA && codeA + 26 > code) {
                    temp = code - codeA + 10;
                }
                if (-1 != temp) {
                    temp = (temp + 55 - i) % 36;
                    if (10 > temp) {
                        result += String.fromCharCode(temp + code0);
                    } else {
                        result += String.fromCharCode(temp + codeA - 10);
                    }
                } else {
                    result += char;
                }
            }
            return result
        }
        function encodeAccountID(id) {
            return (7 * parseInt(id) + 1117113 ^ 86216345) + 1358437;
        }
        function decodeAccountID(id) {
            return ((parseInt(id) - 1358437 ^ 86216345) - 1117113) / 7;
        }
        function encode_account_id2(p) {
            p = 6139246 ^ p;
            var H = 67108863,
                S = p & ~H,
                Z = p & H;
            return Z = (511 & Z) << 17 | Z >> 9,
                Z = (511 & Z) << 17 | Z >> 9,
                Z = (511 & Z) << 17 | Z >> 9,
                Z = (511 & Z) << 17 | Z >> 9,
                Z = (511 & Z) << 17 | Z >> 9,
                Z + S + 1e7
        }
        function decode_account_id2(p) {
            var H = 67108863;
            p -= 1e7;
            var S = p & ~H,
                Z = p & H;
            return Z = (131071 & Z) << 9 | Z >> 17,
                Z = (131071 & Z) << 9 | Z >> 17,
                Z = (131071 & Z) << 9 | Z >> 17,
                Z = (131071 & Z) << 9 | Z >> 17,
                Z = (131071 & Z) << 9 | Z >> 17,
                S + Z ^ 6139246
        }
        function getZone(id) {
            let i = parseInt(id) >> 23;
            if (0 <= i <= 6) {
                return 'CN';
            }
            else if (7 <= i <= 12) {
                return 'JP';
            }
            else if (13 <= i <= 15) {
                return 'EN';
            }
            else {
                return undefined;
            }
        }
        function origin2encode() {
            let arr = document.querySelector('#origin').value.trimStart().trimEnd().split('\n');
            let encode = '';
            let result = '<p>ğŸ’¡æ™®é€šè½¬åŒ¿åç»“æœï¼š</p>';
            for (let i = 0; i < arr.length; i++) {
                let uuid = /([a-z0-9]{6}\-[a-z0-9]{8}\-[a-z0-9]{4}\-[a-z0-9]{4}\-[a-z0-9]{4}\-[a-z0-9]{12})_a(\d+)(_2)?/.exec(arr[i]);
                if (uuid !== null) {
                    if (uuid[3] === undefined) {
                        encodeUUID = encodePaipuUUID(uuid[1]);
                        encode += arr[i].replace(uuid[0], encodeUUID + '_a' + uuid[2] + '_2\n');
                        let accountid = decodeAccountID(uuid[2]);
                        result += '<p>' + (i + 1) + ': <b>' + uuid[1] + '</b> -> <b>' + encodeUUID + '</b> ä¸»è§†è§’è´¦å·id: <b>' + accountid + '</b> åœ°åŒº: <b>' + getZone(accountid) + '</b> å¥½å‹id: <b>' + encode_account_id2(accountid) + '</b></p>';

                    } else {
                        encode += arr[i] + '\n';
                        result += '<p>' + (i + 1) + ': <b>' + uuid[0] + '</b> å·²æ˜¯åŠ å¯†é“¾æ¥ï¼</p>';
                    }
                } else {
                    encode += arr[i] + '\n';
                    result += '<p>' + (i + 1) + ': æœªæ£€æµ‹åˆ°é›€é­‚ç‰Œè°±é“¾æ¥ï¼</p>';
                }
            }
            document.querySelector('#encode').value = encode;
            document.querySelector('#result').innerHTML = result;
        }
        function encode2origin() {
            let arr = document.querySelector('#encode').value.trimStart().trimEnd().split('\n');
            let origin = '';
            let result = '<p>ğŸ’¡åŒ¿åè½¬æ™®é€šç»“æœï¼š</p>';
            for (let i = 0; i < arr.length; i++) {
                let uuid = /([a-z0-9]{6}\-[a-z0-9]{8}\-[a-z0-9]{4}\-[a-z0-9]{4}\-[a-z0-9]{4}\-[a-z0-9]{12})_a(\d+)(_2)?/.exec(arr[i]);
                if (uuid !== null) {
                    if (uuid[3] !== undefined) {
                        originUUID = decodePaipuUUID(uuid[1]);
                        origin += arr[i].replace(uuid[0], originUUID + '_a' + uuid[2] + '\n');
                        let accountid = decodeAccountID(uuid[2]);
                        result += '<p>' + (i + 1) + ': <b>' + uuid[1] + '</b> -> <b>' + originUUID + '</b> ä¸»è§†è§’è´¦å·id: <b>' + accountid + '</b> åœ°åŒº: <b>' + getZone(accountid) + '</b> å¥½å‹id: <b>' + encode_account_id2(accountid) + '</b></p>';

                    } else {
                        origin += arr[i] + '\n';
                        result += '<p>' + (i + 1) + ': <b>' + uuid[0] + '</b> å·²æ˜¯æ™®é€šé“¾æ¥ï¼</p>';
                    }
                } else {
                    origin += arr[i] + '\n';
                    result += '<p>' + (i + 1) + ': æœªæ£€æµ‹åˆ°é›€é­‚ç‰Œè°±é“¾æ¥ï¼</p>';
                }
            }
            document.querySelector('#origin').value = origin;
            document.querySelector('#result').innerHTML = result;
        }
        function trans() {
            let text = document.querySelector('#trans').value;
            let uuid = /([a-z0-9]{6}\-[a-z0-9]{8}\-[a-z0-9]{4}\-[a-z0-9]{4}\-[a-z0-9]{4}\-[a-z0-9]{12})_a(\d+)(_2)?/.exec(text);
            let result = '';
            let accountid;
            if (uuid !== null) {
                if (document.querySelector('#accountid').checked) {
                    accountid = encodeAccountID(document.querySelector('#inputid').value);
                } else {
                    accountid = encodeAccountID(decode_account_id2(document.querySelector('#inputid').value));
                }
                document.querySelector('#transuuid').value = text.replace(uuid[2], accountid);

                result = '<p>è½¬æ¢å®Œæˆï¼</p>';
            } else {
                result = '<p>è½¬æ¢å¤±è´¥ï¼šæœªæ£€æµ‹åˆ°é›€é­‚ç‰Œè°±é“¾æ¥</p>';
            }
            document.querySelector('#transresult').innerHTML = result;

        }
    </script>

</body>

</html>